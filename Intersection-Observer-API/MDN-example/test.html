<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Intersection Observer API</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
    <div>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras et egestas velit. Phasellus odio lacus, mattis ac blandit sed, egestas et erat. Donec ut pellentesque metus, a pulvinar augue. Vestibulum tincidunt arcu vel erat accumsan, sit amet feugiat justo efficitur. Vivamus ligula purus, aliquet quis leo id, consequat ultrices tortor. Nam suscipit, est sit amet dapibus ultricies, nulla sem mattis ipsum, id dictum nulla dolor ut justo. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.

        Quisque vel venenatis velit. Nunc viverra lobortis turpis. Suspendisse vestibulum orci non sem sollicitudin, sit amet dictum justo vehicula. Aenean mi lectus, tempus sed vestibulum id, faucibus vitae augue. Phasellus erat elit, commodo sed nisl eu, pharetra convallis neque. Cras interdum, dolor id congue sodales, est justo aliquet sem, vel tempus mi lacus vitae ipsum. Sed sit amet risus ac ex convallis molestie at quis erat. Phasellus in tortor lacus. Vivamus id vestibulum lorem. Mauris eget nulla volutpat, vehicula erat vel, fermentum urna. Nullam pulvinar in diam a molestie. Nunc est arcu, consequat a finibus at, placerat a nulla. Nunc consequat hendrerit pellentesque. Nulla malesuada semper lacinia.
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras et egestas velit. Phasellus odio lacus, mattis ac blandit sed, egestas et erat. Donec ut pellentesque metus, a pulvinar augue. Vestibulum tincidunt arcu vel erat accumsan, sit amet feugiat justo efficitur. Vivamus ligula purus, aliquet quis leo id, consequat ultrices tortor. Nam suscipit, est sit amet dapibus ultricies, nulla sem mattis ipsum, id dictum nulla dolor ut justo. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.


    </div>
    <div id="box" class="box">
      <div class="vertical">
        Welcome to <strong>The Box!</strong>
      </div>
    </div>
    <div>
        Quisque vel venenatis velit. Nunc viverra lobortis turpis. Suspendisse vestibulum orci non sem sollicitudin, sit amet dictum justo vehicula. Aenean mi lectus, tempus sed vestibulum id, faucibus vitae augue. Phasellus erat elit, commodo sed nisl eu, pharetra convallis neque. Cras interdum, dolor id congue sodales, est justo aliquet sem, vel tempus mi lacus vitae ipsum. Sed sit amet risus ac ex convallis molestie at quis erat. Phasellus in tortor lacus. Vivamus id vestibulum lorem. Mauris eget nulla volutpat, vehicula erat vel, fermentum urna. Nullam pulvinar in diam a molestie. Nunc est arcu, consequat a finibus at, placerat a nulla. Nunc consequat hendrerit pellentesque. Nulla malesuada semper lacinia.

        Fusce mauris sem, finibus eu lobortis in, posuere eget urna. Integer at arcu a enim volutpat semper. Sed aliquam ante sed metus iaculis ultrices. Proin feugiat nibh vel lectus ullamcorper laoreet sollicitudin et elit. Sed suscipit sapien ut magna sodales convallis. Quisque mattis convallis nulla at pharetra. Aenean vel nunc quam. Sed eget tincidunt sem, a egestas risus. Nulla non tincidunt lorem, nec pretium erat. Sed semper scelerisque dui, finibus tempus arcu malesuada sit amet.

        Suspendisse sed ligula nisi. Duis ultrices dolor lectus. Aliquam at varius ex, sit amet dictum nisl. Donec sit amet fringilla mauris. Vivamus at volutpat odio. Praesent commodo neque tempus placerat lacinia. Nunc sagittis aliquam neque. Vivamus gravida nunc mauris, sed commodo ligula sagittis vitae. Pellentesque ut laoreet odio. Integer consequat dui non massa finibus pellentesque.
        Fusce mauris sem, finibus eu lobortis in, posuere eget urna. Integer at arcu a enim volutpat semper. Sed aliquam ante sed metus iaculis ultrices. Proin feugiat nibh vel lectus ullamcorper laoreet sollicitudin et elit. Sed suscipit sapien ut magna sodales convallis. Quisque mattis convallis nulla at pharetra. Aenean vel nunc quam. Sed eget tincidunt sem, a egestas risus. Nulla non tincidunt lorem, nec pretium erat. Sed semper scelerisque dui, finibus tempus arcu malesuada sit amet.

        Suspendisse sed ligula nisi. Duis ultrices dolor lectus. Aliquam at varius ex, sit amet dictum nisl. Donec sit amet fringilla mauris. Vivamus at volutpat odio. Praesent commodo neque tempus placerat lacinia. Nunc sagittis aliquam neque. Vivamus gravida nunc mauris, sed commodo ligula sagittis vitae. Pellentesque ut laoreet odio. Integer consequat dui non massa finibus pellentesque.

        Fusce mauris sem, finibus eu lobortis in, posuere eget urna. Integer at arcu a enim volutpat semper. Sed aliquam ante sed metus iaculis ultrices. Proin feugiat nibh vel lectus ullamcorper laoreet sollicitudin et elit. Sed suscipit sapien ut magna sodales convallis. Quisque mattis convallis nulla at pharetra. Aenean vel nunc quam. Sed eget tincidunt sem, a egestas risus. Nulla non tincidunt lorem, nec pretium erat. Sed semper scelerisque dui, finibus tempus arcu malesuada sit amet.
        Suspendisse sed ligula nisi. Duis ultrices dolor lectus. Aliquam at varius ex, sit amet dictum nisl. Donec sit amet fringilla mauris. Vivamus at volutpat odio. Praesent commodo neque tempus placerat lacinia. Nunc sagittis aliquam neque. Vivamus gravida nunc mauris, sed commodo ligula sagittis vitae. Pellentesque ut laoreet odio. Integer consequat dui non massa finibus pellentesque.
        Fusce mauris sem, finibus eu lobortis in, posuere eget urna. Integer at arcu a enim volutpat semper. Sed aliquam ante sed metus iaculis ultrices. Proin feugiat nibh vel lectus ullamcorper laoreet sollicitudin et elit. Sed suscipit sapien ut magna sodales convallis. Quisque mattis convallis nulla at pharetra. Aenean vel nunc quam. Sed eget tincidunt sem, a egestas risus. Nulla non tincidunt lorem, nec pretium erat. Sed semper scelerisque dui, finibus tempus arcu malesuada sit amet.
    </div>
    <div id="box2" class="box">
      <div class="vertical">
        Welcome to <strong>The Box!</strong>
      </div>
    </div>
    <div>
        Suspendisse sed ligula nisi. Duis ultrices dolor lectus. Aliquam at varius ex, sit amet dictum nisl. Donec sit amet fringilla mauris. Vivamus at volutpat odio. Praesent commodo neque tempus placerat lacinia. Nunc sagittis aliquam neque. Vivamus gravida nunc mauris, sed commodo ligula sagittis vitae. Pellentesque ut laoreet odio. Integer consequat dui non massa finibus pellentesque.
    </div>

<script type='text/javascript'>
    const numSteps = 20.0;

    let prevRatio = 0.0;

    // Set things up
    var targets;

    window.addEventListener("load", (event) => {
      targets = Array.from(document.querySelectorAll('.box'));

      createObserver();
    }, false);

    function createObserver() {
      let observer;

      let options = {
        root: null,
        rootMargin: "30px",
        threshold: buildThresholdList()
      };

      observer = new IntersectionObserver(handleIntersect, options);
      targets.forEach(t => observer.observe(t));
    }
    function buildThresholdList() {
      let thresholds = [];
      let numSteps = 20;

      for (let i=1.0; i<=numSteps; i++) {
        let ratio = i/numSteps;
        thresholds.push(ratio);
      }

      thresholds.push(0);
      return thresholds;
    }

    function handleIntersect(entries, observer) {
      entries.forEach((entry) => {
         entry.target.style.opacity = entry.intersectionRatio;
        prevRatio = entry.intersectionRatio;
      });
}
</script>
</body>
</html>
